---
title: "pollen AF"
author: "Meng"
date: "2024-05-18"
output: html_document
---

```{r setup, include=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)
setwd("/Users/yuanmeng/Library/CloudStorage/OneDrive-UniversityofToronto/Manuscripts/pollen_competition/")
```

# cross 5, TX
```{r}
freq_cross <- read.table("cross5_35h_pollen.vcf.freq")
colnames(freq_cross) <- c("chrom", "start", "end", "no_sites", "leaf_freq", "pollen_freq")
freq_cross <- freq_cross %>% filter(no_sites > 100)
freq_cross$chrom <- factor(freq_cross$chrom)

freq_long_cross <- gather(freq_cross, Category, freq, leaf_freq : pollen_freq, factor_key = TRUE)
levels(freq_long_cross$Category) <- c("leaf", "pollen")   
```

```{r}
p1 <- ggplot(freq_cross, aes(x = start/1000000, y = no_sites))+geom_point(size = 0.3, alpha = 0.8, colour = "darkgrey")+ geom_smooth(colour = "black")+
    facet_grid(.~chrom,scales="free_x", switch = "x", space = "free_x") + 
    xlab("")+ylab("Number of SNPs")+theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.ticks.x = element_blank(),panel.spacing = unit(0.1, "cm"),strip.background = element_blank(),strip.placement = "outside")+ theme(text = element_text(size = 10))

p2 <- ggplot(freq_long_cross, aes(x = start/1000000, y = freq))+geom_point(aes(colour = Category), size = 0.3, alpha=0.3)+ geom_smooth(aes(colour = Category))+ facet_grid(.~chrom,scales="free_x", switch = "x", space = "free_x") +  xlab("Position on Chromosome (Mb)")+ylab("Allele frequency")+theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.ticks.x = element_blank(),panel.spacing = unit(0.1, "cm"),strip.background = element_blank(),strip.placement = "outside")+ theme(text = element_text(size = 10))

p1 + p2  + plot_layout(nrow = 2, byrow = FALSE)
```






